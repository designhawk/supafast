import{p as s,H as t,c as i,h as e,t as n}from"./p-mxJ7F0UG.js";import{i as o,d as h,t as a}from"./p-94ZtGp9D.js";import{c}from"./p-BfP9ezJQ.js";const d=()=>`:host{display:inline-block}`;const l=s(class s extends t{constructor(s){super();if(s!==false){this.__registerHost()}this.__attachShadow();this.ifxOpen=i(this,"ifxOpen",7);this.ifxClose=i(this,"ifxClose",7);this.ifxDropdown=i(this,"ifxDropdown",7)}placement="bottom-start";defaultOpen=false;internalIsOpen=false;noAppendToBody=false;ifxOpen;ifxClose;ifxDropdown;disabled;noCloseOnOutsideClick=false;noCloseOnMenuClick=false;get el(){return this}trigger;menu;popperInstance;handleOutsideClick(s){const t=s.target;if(!this.noCloseOnOutsideClick&&!this.el.contains(t)&&!this.menu.contains(t)){this.closeDropdown()}}handleFocusOutside(s){const t=s.target;if(this.internalIsOpen&&!this.el.contains(t)&&!this.menu.contains(t)){this.closeDropdown()}}handleTriggerClick=()=>{if(!this.internalIsOpen)this.openDropdown();else this.closeDropdown()};handleTriggerKeyDown=s=>{const t=s.key;if(t==="Tab"&&this.internalIsOpen&&!s.shiftKey){s.preventDefault();this.focusFirstItem()}};handleMenuClick=()=>{if(!this.noCloseOnMenuClick)this.closeDropdown()};getItemFocusables(){if(!this.menu)return[];const s=Array.from(this.menu.querySelectorAll("ifx-dropdown-item"));return s.filter((s=>!(s.getAttribute("hide")==="true"||s.classList.contains("hide")))).map((s=>s.shadowRoot?.querySelector("a"))).filter((s=>!!s))}handleMenuKeyDown=s=>{const t=this.getItemFocusables();if(!t.length)return;const i=t.indexOf(document.activeElement);switch(s.key){case"ArrowDown":s.preventDefault();t[(i+1)%t.length].focus();break;case"ArrowUp":s.preventDefault();t[(i-1+t.length)%t.length].focus();break;case"Home":s.preventDefault();t[0].focus();break;case"End":s.preventDefault();t[t.length-1].focus();break;case"Enter":case" ":case"Spacebar":s.preventDefault();document.activeElement?.click();break;case"Escape":s.preventDefault();this.closeDropdown();this.trigger?.focus();break;case"Tab":if(s.shiftKey&&i===0){s.preventDefault();this.closeDropdown();this.trigger?.focus()}break}};componentWillLoad(){this.updateSlotContent();this.watchHandlerIsOpen(this.defaultOpen,this.internalIsOpen)}async componentDidLoad(){if(!o(this.el)){const s=h();a("ifx-dropdown",await s)}}watchHandlerIsOpen(s,t){if(s!==t&&s!==this.internalIsOpen){if(s){this.openDropdown()}else{this.closeDropdown()}}}watchHandlerDisabled(s){if(this.trigger){this.trigger.disabled=s}}watchHandlerSlot(){this.updateSlotContent()}focusFirstItem(){const[s]=this.getItemFocusables();s?.focus()}updateSlotContent(){const s=this.el.querySelector("ifx-dropdown-trigger-button, ifx-dropdown-trigger");if(s!==this.trigger){if(this.trigger){this.trigger.removeEventListener("click",this.handleTriggerClick);this.trigger.removeEventListener("keydown",this.handleTriggerKeyDown)}this.trigger=s;if(this.trigger){this.trigger.disabled=this.disabled;this.trigger.addEventListener("click",this.handleTriggerClick);this.trigger.addEventListener("keydown",this.handleTriggerKeyDown)}}const t=this.el.querySelector("ifx-dropdown-menu");if(!this.noAppendToBody){if(this.menu&&this.menu!==t){this.menu.removeEventListener("click",this.handleMenuClick);this.menu.removeEventListener("keydown",this.handleMenuKeyDown);this.menu.remove()}this.menu=t;if(this.menu&&!document.body.contains(this.menu)){document.body.append(this.menu)}}else{this.menu=t}if(this.menu){this.menu.removeEventListener("click",this.handleMenuClick);this.menu.removeEventListener("keydown",this.handleMenuKeyDown);this.menu.addEventListener("click",this.handleMenuClick);this.menu.addEventListener("keydown",this.handleMenuKeyDown)}}menuClickHandler(){if(!this.noCloseOnMenuClick){this.closeDropdown()}}disconnectedCallback(){if(this.popperInstance){this.popperInstance.destroy();this.popperInstance=null}if(this.menu){this.menu.remove()}}async isOpen(){return this.internalIsOpen}async closeDropdown(){if(this.internalIsOpen){this.internalIsOpen=false;this.trigger.isOpen=false;this.menu.isOpen=false;this.ifxClose.emit()}if(this.popperInstance){this.popperInstance.destroy();this.popperInstance=null}}async openDropdown(){if(!this.internalIsOpen&&!this.disabled){this.internalIsOpen=true;this.trigger.isOpen=true;this.menu.isOpen=true;this.popperInstance=c(this.el,this.menu,{placement:this.placement});this.ifxOpen.emit()}}render(){return e("div",{key:"4e98de0e83c6d6ff4416c495270f198bcabcf958","aria-label":"dropdown menu",class:"dropdown"},e("slot",{key:"a89296bd4a261e051586dade43c3815803969aec"}))}static get watchers(){return{defaultOpen:[{watchHandlerIsOpen:0}],disabled:[{watchHandlerDisabled:0}]}}static get style(){return d()}},[769,"ifx-dropdown",{placement:[1],defaultOpen:[4,"default-open"],noAppendToBody:[4,"no-append-to-body"],disabled:[4],noCloseOnOutsideClick:[4,"no-close-on-outside-click"],noCloseOnMenuClick:[4,"no-close-on-menu-click"],internalIsOpen:[32],trigger:[32],menu:[32],isOpen:[64],closeDropdown:[64],openDropdown:[64]},[[5,"mousedown","handleOutsideClick"],[4,"focusin","handleFocusOutside"],[0,"slotchange","watchHandlerSlot"]],{defaultOpen:[{watchHandlerIsOpen:0}],disabled:[{watchHandlerDisabled:0}]}]);function r(){if(typeof customElements==="undefined"){return}const s=["ifx-dropdown"];s.forEach((s=>{switch(s){case"ifx-dropdown":if(!customElements.get(n(s))){customElements.define(n(s),l)}break}}))}const f=l;const p=r;export{f as IfxDropdown,p as defineCustomElement};
//# sourceMappingURL=ifx-dropdown.js.map