{"version":3,"names":["fileUploadCss","FileUpload","__stencil_proxyCustomElement","HTMLElement","dragAndDrop","required","disabled","maxFileSizeMB","allowedFileTypes","undefined","additionalAllowedFileTypes","allowAnyFileType","allowedFileExtensions","uploadHandler","_maxFiles","maxFiles","this","value","console","warn","label","labelRequiredError","labelBrowseFiles","labelDragAndDrop","labelUploadedFilesHeading","labelFileTooLarge","labelUnsupportedFileType","labelUploaded","labelUploadFailed","labelSupportedFormatsTemplate","labelFileSingular","labelFilePlural","labelMaxFilesInfo","labelMaxFilesExceeded","ariaLabelBrowseFiles","ariaLabelDropzone","ariaLabelFileInput","ariaLabelRemoveFile","ariaLabelCancelUpload","ariaLabelRetryUpload","ariaLabelUploadingStatus","ariaLabelUploadedStatus","ariaLabelUploadFailedStatus","showDemoStates","internalId","Math","random","toString","substr","isDragOver","files","uploadTasks","rejectedSizeFiles","rejectedTypeFiles","requiredError","statusMessage","ifxFileUploadAdd","ifxFileUploadRemove","ifxFileUploadChange","ifxFileUploadError","ifxFileUploadInvalid","ifxFileUploadStart","ifxFileUploadComplete","ifxFileUploadAllComplete","ifxFileUploadAbort","ifxFileUploadDrop","ifxFileUploadClick","ifxFileUploadMaxFilesExceeded","ifxFileUploadValidation","ifxFileUploadRetry","fileInputEl","extensionToMimeMap","jpg","jpeg","png","gif","svg","webp","pdf","doc","docx","xls","xlsx","ppt","pptx","txt","csv","json","mp3","wav","mp4","mov","webm","zip","rar","tar","gz","xml","html","css","js","validateRequired","length","text","type","emit","valid","pluralize","count","getNormalizedFileTypes","getNormalizedFileExtensions","Array","isArray","JSON","parse","split","map","t","trim","isFileTypeAllowed","file","fileExtension","getFileExtension","name","normalizedTypes","allowedMimes","ext","toLowerCase","filter","Boolean","includes","additionalMimeTypes","getAdditionalMimeTypes","customExtensions","normalizedExt","startsWith","substring","filename","lastDotIndex","lastIndexOf","getLabelFromMimeType","mime","knownMime","Object","entries","toUpperCase","handleFileChange","event","input","target","processFiles","handleDrop","preventDefault","stopPropagation","dataTransfer","droppedFiles","from","acceptedFiles","rejectedFiles","forEach","isValidType","isValidSize","size","push","handleDragOver","handleDragLeave","fileList","selectedFiles","validFiles","rejectedSize","rejectedType","isDuplicate","some","existing","reason","errorType","message","availableSlots","limitedFiles","slice","max","overflowFiles","startUpload","addedFiles","replace","attempted","retryUpload","taskIndex","findIndex","splice","checkAndEmitAllComplete","every","completed","error","hasSuccessfulUploads","successfulFiles","resetFileInput","updateTaskProgress","progress","task","find","newProgress","min","intervalId","percent","then","catch","totalSize","fakeUploadSpeed","uploaded","window","setInterval","round","clearInterval","cancelUpload","_","i","f","removeFile","removedFile","clearRejectedFile","fileName","splitFileNameParts","dotIndex","base","getFileIcon","extension","pop","formatSize","bytes","toFixed","getAcceptAttribute","acceptValues","extensionTypes","mimeTypes","join","getFormattedProgressText","uploadedSize","uploadedText","totalText","getSupportedFileText","fileWord","maxFilesText","allTypes","extensions","cleanExt","typesLabel","getFormattedFileTooLargeText","renderStatusMessage","h","class","icon","isInputDisabled","componentDidLoad","isNestedInIfxComponent","hostElement","framework","detectFramework","trackComponent","hasAttribute","injectDemoState","dummyContent","fill","bigContent","uploading","File","failed","tooLarge","unsupported","triggerDemoValidation","render","key","htmlFor","renderDragAndDropArea","renderUploadArea","shape","variant","onClick","isUploading","isError","itemClass","uniqueKey","style","display","handleInputRef","el","click","id","ref","accept","multiple","onChange","e","triggerInputClick","onDragOver","onDragLeave","onDrop","role","tabIndex","height","overflow"],"sources":["src/components/file-upload/file-upload.scss?tag=ifx-file-upload&encapsulation=shadow","src/components/file-upload/file-upload.tsx"],"sourcesContent":["@use \"~@infineon/design-system-tokens/dist/tokens\";\n\n:host {\n  // TODO remove\n  font-family: var(--ifx-font-family, sans-serif);\n}\n\n.file-upload-wrapper {\n  display: flex;\n  flex-direction: column;\n\n  &.disabled {\n    pointer-events: none;\n\n    label,\n    .file-upload-info {\n      color: tokens.$ifxColorEngineering500;\n    }\n  }\n}\n\n.file-upload-label {\n  font-style: normal;\n  font-weight: 400;\n  font-size: tokens.$ifxFontSizeM;\n  line-height: tokens.$ifxLineHeightM;\n  color: tokens.$ifxColorBaseBlack;\n\n  .required {\n    display: inline-block;\n    margin-left: 4px;\n\n    &.error {\n      color: tokens.$ifxColorRed500;\n    }\n  }\n}\n\n.upload-dropzone {\n  border: 1px dashed tokens.$ifxColorEngineering300;\n  padding: tokens.$ifxSpace500;\n  text-align: center;\n  cursor: pointer;\n  color: tokens.$ifxColorBaseBlack;\n  transition: border-color 0.3s ease;\n  border-radius: tokens.$ifxBorderRadius12;\n  background: tokens.$ifxColorBaseWhite;\n\n  ifx-icon {\n    color: tokens.$ifxColorOcean500;\n  }\n\n  &:hover {\n    border: 1px dashed tokens.$ifxColorEngineering400;\n  }\n\n  &.drag-over {\n    border: 1px solid tokens.$ifxColorOcean500;\n    background: tokens.$ifxColorEngineering100;\n\n    &.error {\n      border: 1px solid tokens.$ifxColorOcean500;\n    }\n  }\n\n  &.error {\n    border-color: tokens.$ifxColorRed500;\n  }\n\n  .disabled & {\n    pointer-events: none;\n    border-color: tokens.$ifxColorEngineering300;\n    color: tokens.$ifxColorEngineering300;\n\n    ifx-icon {\n      color: tokens.$ifxColorEngineering300;\n    }\n  }\n}\n\n.upload-dropzone input {\n  display: none;\n}\n\n.file-upload-info {\n  font-style: normal;\n  font-weight: tokens.$ifxFontWeightRegular;\n  font-size: tokens.$ifxFontSizeXs;\n  line-height: tokens.$ifxLineHeightXs;\n  letter-spacing: tokens.$ifxLetterSpacingDefault;\n  color: tokens.$ifxColorBaseBlack;\n  margin: 0;\n  margin-top: tokens.$ifxSpace50;\n}\n\n.file-upload-status {\n  font-style: normal;\n  font-weight: 400;\n  font-size: tokens.$ifxFontSizeXs;\n  line-height: tokens.$ifxLineHeightXs;\n  letter-spacing: 0.2px;\n  margin-top: tokens.$ifxSpace100;\n\n  &.file-upload-status__error {\n    display: flex;\n    align-items: center;\n    color: tokens.$ifxColorRed500;\n\n    ifx-icon {\n      position: relative;\n      top: - tokens.$ifxSpace12;\n      color: tokens.$ifxColorRed500;\n      margin-right: tokens.$ifxSpace100;\n    }\n  }\n}\n\n.upload-heading {\n  font: tokens.$ifxHeadingHeading06;\n  margin-bottom: tokens.$ifxSpace100;\n}\n\n.file-list-wrapper {\n  margin-top: tokens.$ifxSpace200;\n}\n\n.file-list {\n  list-style: none;\n  padding: 0;\n  margin: 0;\n  display: flex;\n  flex-direction: column;\n  gap: tokens.$ifxSpace200;\n}\n\n.file-item {\n  border: 1px solid tokens.$ifxColorEngineering300;\n  padding-top: tokens.$ifxSpace150;\n  padding-right: tokens.$ifxSpace200;\n  padding-bottom: tokens.$ifxSpace100;\n  padding-left: tokens.$ifxSpace200;\n  display: flex;\n  gap: tokens.$ifxSpace100;\n}\n\n.file-info {\n  width: 100%;\n  min-width: 0;\n}\n\n.file-top-row {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: tokens.$ifxSpace200;\n  margin-top: - tokens.$ifxSpace100;\n}\n\n.file-top-row ifx-icon {\n  flex-shrink: 0;\n}\n\n.file-name-wrapper {\n  display: flex;\n  min-width: 0;\n  max-width: 100%;\n  white-space: nowrap;\n  overflow: hidden;\n  font-weight: tokens.$ifxFontWeightRegular;\n  font-size: tokens.$ifxFontSizeS;\n}\n\n.file-name-base {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  flex-shrink: 1;\n  min-width: 0;\n}\n\n.file-name-ext {\n  flex-shrink: 0;\n  margin-left: 0;\n}\n\n.file-middle-row {\n  display: flex;\n  align-items: center;\n  font-size: tokens.$ifxFontSizeXs;\n  line-height: tokens.$ifxLineHeightXs;\n  flex-wrap: wrap;\n  color: tokens.$ifxColorEngineering500;\n\n  .file-status {\n    margin-left: tokens.$ifxSpace150;\n\n    ifx-icon {\n      margin-right: tokens.$ifxSpace100;\n    }\n  }\n}\n\n.file-progress-row {\n  margin-top: tokens.$ifxSpace50;\n}\n\n.file-progress-row ifx-progress-bar {\n  width: 100%;\n}\n\n.upload-success {\n  border-color: tokens.$ifxColorOcean500;\n\n  .file-status {\n    ifx-icon {\n      position: relative;\n      top: tokens.$ifxSpace12;\n      color: tokens.$ifxColorGreen500;\n    }\n  }\n}\n\n.upload-failed {\n  border-color: tokens.$ifxColorRed500;\n\n  .file-status {\n    color: tokens.$ifxColorRed500;\n    margin-left: 0;\n  }\n}\n","import {\n\tComponent,\n\tElement,\n\tEvent,\n\ttype EventEmitter,\n\th,\n\tMethod,\n\tProp,\n\tState,\n} from \"@stencil/core\";\nimport { isNestedInIfxComponent } from \"../..//shared/utils/dom-utils\";\nimport { detectFramework } from \"../..//shared/utils/framework-detection\";\nimport { trackComponent } from \"../../shared/utils/tracking\";\n\ninterface UploadTask {\n\tfile: File;\n\tprogress: number;\n\tintervalId: number | null;\n\tcompleted: boolean;\n\terror?: boolean;\n}\n\nexport type FileUploadErrorReason =\n\t| \"network-error\"\n\t| \"timeout\"\n\t| \"file-too-large\"\n\t| \"unsupported-type\"\n\t| \"invalid-type\"\n\t| \"custom\"\n\t| (string & {});\n\n@Component({\n\ttag: \"ifx-file-upload\",\n\tstyleUrl: \"file-upload.scss\",\n\tshadow: true,\n})\nexport class FileUpload {\n\t@Element() hostElement: HTMLElement;\n\n\t@Prop() dragAndDrop: boolean = false;\n\t@Prop() required: boolean = false;\n\t@Prop() disabled: boolean = false;\n\t@Prop() maxFileSizeMB: number = 7;\n\t/** Default set of allowed file extensions (used internally). Can be extended using `additionalAllowedFileTypes`. */\n\t@Prop() allowedFileTypes?: string | string[] = undefined;\n\t@Prop() additionalAllowedFileTypes?: string | string[] = [];\n\t/** When set to true, allows any file type to be uploaded (no file type restrictions). */\n\t@Prop() allowAnyFileType: boolean = false;\n\t/** Custom file extensions to allow (e.g., 'xml', 'asc', 'cfg'). Recommended format: without dots. Also accepts format with dots like '.xml'. Do not use wildcards like '*.xml'. */\n\t@Prop() allowedFileExtensions?: string | string[] = [];\n\t@Prop() uploadHandler?: (\n\t\tfile: File,\n\t\tonProgress?: (progress: number) => void,\n\t) => Promise<void>;\n\n\tprivate _maxFiles?: number;\n\t@Prop()\n\tget maxFiles(): number | undefined {\n\t\treturn this._maxFiles;\n\t}\n\tset maxFiles(value: number | undefined) {\n\t\tif (typeof value === \"number\" && value < 1) {\n\t\t\tconsole.warn(\"Invalid `maxFiles` value. Must be >= 1. Value ignored.\");\n\t\t\tthis._maxFiles = undefined;\n\t\t} else {\n\t\t\tthis._maxFiles = value;\n\t\t}\n\t}\n\n\t@Prop() label: string = \"Label\";\n\t@Prop() labelRequiredError: string = \"At least one file must be uploaded\";\n\t@Prop() labelBrowseFiles: string = \"Browse files\";\n\t@Prop() labelDragAndDrop: string = \"Drag & Drop or browse files to upload\";\n\t@Prop() labelUploadedFilesHeading: string = \"Uploaded files\";\n\t@Prop() labelFileTooLarge: string =\n\t\t\"Upload failed. Max file size: {{size}}MB.\";\n\t@Prop() labelUnsupportedFileType: string = \"Unsupported file type.\";\n\t@Prop() labelUploaded: string = \"Successfully uploaded\";\n\t@Prop() labelUploadFailed: string = \"Upload failed. Please try again.\";\n\t@Prop() labelSupportedFormatsTemplate: string =\n\t\t\"Supported file formats: {{types}}. Max file size: {{size}}MB.\";\n\t@Prop() labelFileSingular: string = \"file\";\n\t@Prop() labelFilePlural: string = \"files\";\n\t@Prop() labelMaxFilesInfo?: string = \"Up to {{count}} {{files}}.\";\n\t@Prop() labelMaxFilesExceeded: string =\n\t\t\"Upload limit exceeded. Only {{count}} {{files}} allowed.\";\n\n\t@Prop() ariaLabelBrowseFiles: string = \"Browse files\";\n\t@Prop() ariaLabelDropzone: string =\n\t\t\"Upload area. Click to browse or drag and drop files.\";\n\t@Prop() ariaLabelFileInput: string = \"Upload file\";\n\t@Prop() ariaLabelRemoveFile: string = \"Remove file\";\n\t@Prop() ariaLabelCancelUpload: string = \"Cancel upload\";\n\t@Prop() ariaLabelRetryUpload: string = \"Retry upload\";\n\t@Prop() ariaLabelUploadingStatus: string = \"Upload in progress\";\n\t@Prop() ariaLabelUploadedStatus: string = \"Upload completed\";\n\t@Prop() ariaLabelUploadFailedStatus: string = \"Upload failed\";\n\n\tprivate showDemoStates?: boolean;\n\tprivate internalId =\n\t\t`ifx-file-upload-${Math.random().toString(36).substr(2, 9)}`;\n\n\t@State() isDragOver: boolean = false;\n\t@State() files: File[] = [];\n\t@State() uploadTasks: UploadTask[] = [];\n\t@State() rejectedSizeFiles: string[] = [];\n\t@State() rejectedTypeFiles: string[] = [];\n\t@State() requiredError: boolean = false;\n\t@State() statusMessage: {\n\t\ttype: \"error\" | \"info\" | \"success\";\n\t\ttext: string;\n\t} | null = null;\n\n\t@Event() ifxFileUploadAdd: EventEmitter<{\n\t\taddedFiles: File[];\n\t\tfiles: File[];\n\t}>;\n\t@Event() ifxFileUploadRemove: EventEmitter<{\n\t\tremovedFile: File;\n\t\tfiles: File[];\n\t}>;\n\t@Event() ifxFileUploadChange: EventEmitter<{ files: File[] }>;\n\t@Event() ifxFileUploadError: EventEmitter<{\n\t\terrorType: string;\n\t\tfile: File;\n\t\tmessage: string;\n\t\treason?: string;\n\t}>;\n\t@Event() ifxFileUploadInvalid: EventEmitter<{ file: File; reason: string }>;\n\t@Event() ifxFileUploadStart: EventEmitter<{ file: File }>;\n\t@Event() ifxFileUploadComplete: EventEmitter<{ file: File }>;\n\t@Event() ifxFileUploadAllComplete: EventEmitter<{ files: File[] }>;\n\t@Event() ifxFileUploadAbort: EventEmitter<{ file: File }>;\n\t@Event() ifxFileUploadDrop: EventEmitter<{\n\t\tdroppedFiles: File[];\n\t\tacceptedFiles: File[];\n\t\trejectedFiles: File[];\n\t}>;\n\t@Event() ifxFileUploadClick: EventEmitter<void>;\n\t@Event() ifxFileUploadMaxFilesExceeded: EventEmitter<{\n\t\tmaxFiles: number;\n\t\tattempted: number;\n\t}>;\n\t@Event() ifxFileUploadValidation: EventEmitter<{ valid: boolean }>;\n\t@Event() ifxFileUploadRetry: EventEmitter<{ file: File }>;\n\n\tprivate fileInputEl: HTMLInputElement | null = null;\n\n\tprivate extensionToMimeMap: Record<string, string> = {\n\t\t/**\n\t\t * Maps file extensions to MIME types.\n\t\t * This is only used for translating `allowedFileTypes` (extensions) into MIME types,\n\t\t * and for labeling in the UI. It does NOT define which files are globally allowed.\n\t\t */\n\n\t\t// Images\n\t\tjpg: \"image/jpeg\",\n\t\tjpeg: \"image/jpeg\",\n\t\tpng: \"image/png\",\n\t\tgif: \"image/gif\",\n\t\tsvg: \"image/svg+xml\",\n\t\twebp: \"image/webp\",\n\n\t\t// Documents\n\t\tpdf: \"application/pdf\",\n\t\tdoc: \"application/msword\",\n\t\tdocx: \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\",\n\t\txls: \"application/vnd.ms-excel\",\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\",\n\t\tppt: \"application/vnd.ms-powerpoint\",\n\t\tpptx: \"application/vnd.openxmlformats-officedocument.presentationml.presentation\",\n\t\ttxt: \"text/plain\",\n\t\tcsv: \"text/csv\",\n\t\tjson: \"application/json\",\n\n\t\t// Audio/Video\n\t\tmp3: \"audio/mpeg\",\n\t\twav: \"audio/wav\",\n\t\tmp4: \"video/mp4\",\n\t\tmov: \"video/quicktime\",\n\t\twebm: \"video/webm\",\n\n\t\t// Archive / Code\n\t\tzip: \"application/zip\",\n\t\trar: \"application/vnd.rar\",\n\t\ttar: \"application/x-tar\",\n\t\tgz: \"application/gzip\",\n\n\t\t// Sonstiges\n\t\txml: \"application/xml\",\n\t\thtml: \"text/html\",\n\t\tcss: \"text/css\",\n\t\tjs: \"application/javascript\",\n\t};\n\n\tprivate validateRequired(): void {\n\t\tif (this.required && this.files.length === 0) {\n\t\t\tthis.requiredError = true;\n\n\t\t\tif (this.statusMessage?.text !== this.labelRequiredError) {\n\t\t\t\tthis.statusMessage = {\n\t\t\t\t\ttype: \"error\",\n\t\t\t\t\ttext: this.labelRequiredError,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tthis.ifxFileUploadValidation.emit({ valid: false });\n\t\t} else {\n\t\t\tthis.requiredError = false;\n\n\t\t\tif (this.statusMessage?.text === this.labelRequiredError) {\n\t\t\t\tthis.statusMessage = null;\n\t\t\t}\n\n\t\t\tthis.ifxFileUploadValidation.emit({ valid: true });\n\t\t}\n\t}\n\n\tprivate pluralize(count: number): string {\n\t\t// If allowAnyFileType is true, use generic terms\n\t\tif (this.allowAnyFileType) {\n\t\t\treturn count === 1 ? \"file\" : \"files\";\n\t\t}\n\t\treturn count === 1 ? this.labelFileSingular : this.labelFilePlural;\n\t}\n\n\tprivate getNormalizedFileTypes(): string[] {\n\t\t// If allowedFileTypes is not set and allowedFileExtensions is set, return empty array\n\t\tif (\n\t\t\t!this.allowedFileTypes &&\n\t\t\tthis.allowedFileExtensions &&\n\t\t\tthis.getNormalizedFileExtensions().length > 0\n\t\t) {\n\t\t\treturn [];\n\t\t}\n\n\t\t// If allowedFileTypes is not set and no allowedFileExtensions, use defaults\n\t\tif (!this.allowedFileTypes) {\n\t\t\treturn [\"jpg\", \"jpeg\", \"png\", \"pdf\", \"mov\", \"mp3\", \"mp4\"];\n\t\t}\n\n\t\tif (Array.isArray(this.allowedFileTypes)) {\n\t\t\treturn this.allowedFileTypes;\n\t\t}\n\t\ttry {\n\t\t\treturn JSON.parse(this.allowedFileTypes);\n\t\t} catch {\n\t\t\treturn this.allowedFileTypes.split(\",\").map((t) => t.trim());\n\t\t}\n\t}\n\n\tprivate getNormalizedFileExtensions(): string[] {\n\t\tif (!this.allowedFileExtensions) return [];\n\t\tif (Array.isArray(this.allowedFileExtensions)) {\n\t\t\treturn this.allowedFileExtensions;\n\t\t}\n\t\ttry {\n\t\t\treturn JSON.parse(this.allowedFileExtensions);\n\t\t} catch {\n\t\t\treturn this.allowedFileExtensions.split(\",\").map((t) => t.trim());\n\t\t}\n\t}\n\n\t/**\n\t * Enhanced file type validation that supports:\n\t * - allowAnyFileType flag for unrestricted uploads (overrides all restrictions)\n\t * - allowedFileTypes (predefined extensions mapped to MIME types) - if not set and allowedFileExtensions is set, ignored\n\t * - additionalAllowedFileTypes (MIME types)\n\t * - allowedFileExtensions (custom extensions) - if only this is set, only these extensions are allowed\n\t */\n\tprivate isFileTypeAllowed(file: File): boolean {\n\t\t// If allowAnyFileType is true, accept all files (overrides all restrictions)\n\t\tif (this.allowAnyFileType) {\n\t\t\treturn true;\n\t\t}\n\n\t\tconst fileExtension = this.getFileExtension(file.name);\n\n\t\t// Check against allowedFileTypes (predefined extensions)\n\t\tconst normalizedTypes = this.getNormalizedFileTypes();\n\t\tconst allowedMimes = normalizedTypes\n\t\t\t.map((ext) => this.extensionToMimeMap[ext.toLowerCase()])\n\t\t\t.filter(Boolean);\n\n\t\tif (allowedMimes.includes(file.type)) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Check against additionalAllowedFileTypes (MIME types)\n\t\tconst additionalMimeTypes = this.getAdditionalMimeTypes();\n\t\tif (additionalMimeTypes.includes(file.type)) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Check against allowedFileExtensions (custom extensions)\n\t\tconst customExtensions = this.getNormalizedFileExtensions();\n\t\tif (customExtensions.length > 0 && fileExtension) {\n\t\t\tfor (const ext of customExtensions) {\n\t\t\t\tconst normalizedExt = ext.startsWith(\".\")\n\t\t\t\t\t? ext.substring(1).toLowerCase()\n\t\t\t\t\t: ext.toLowerCase();\n\t\t\t\tif (fileExtension === normalizedExt) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t * Extracts file extension from filename (without dot)\n\t */\n\tprivate getFileExtension(filename: string): string | null {\n\t\tconst lastDotIndex = filename.lastIndexOf(\".\");\n\t\tif (lastDotIndex === -1 || lastDotIndex === filename.length - 1) {\n\t\t\treturn null;\n\t\t}\n\t\treturn filename.substring(lastDotIndex + 1).toLowerCase();\n\t}\n\n\tprivate getLabelFromMimeType(mime: string): string {\n\t\tfor (const [ext, knownMime] of Object.entries(this.extensionToMimeMap)) {\n\t\t\tif (knownMime === mime) {\n\t\t\t\treturn ext.toUpperCase();\n\t\t\t}\n\t\t}\n\t\treturn mime; // fallback: show raw MIME\n\t}\n\n\thandleFileChange(event: Event) {\n\t\tconst input = event.target as HTMLInputElement;\n\t\tif (!input.files) return;\n\t\tthis.processFiles(input.files);\n\t}\n\n\thandleDrop(event: DragEvent) {\n\t\tif (this.disabled) return;\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\tthis.isDragOver = false;\n\t\tif (event.dataTransfer?.files) {\n\t\t\tconst droppedFiles = Array.from(event.dataTransfer.files);\n\n\t\t\tconst acceptedFiles: File[] = [];\n\t\t\tconst rejectedFiles: File[] = [];\n\n\t\t\tdroppedFiles.forEach((file) => {\n\t\t\t\tconst isValidType = this.isFileTypeAllowed(file);\n\t\t\t\tconst isValidSize = file.size <= this.maxFileSizeMB * 1024 * 1024;\n\t\t\t\tif (isValidType && isValidSize) acceptedFiles.push(file);\n\t\t\t\telse rejectedFiles.push(file);\n\t\t\t});\n\n\t\t\tthis.ifxFileUploadDrop.emit({\n\t\t\t\tdroppedFiles,\n\t\t\t\tacceptedFiles,\n\t\t\t\trejectedFiles,\n\t\t\t});\n\n\t\t\tthis.processFiles(event.dataTransfer.files);\n\t\t}\n\t}\n\n\thandleDragOver(event: DragEvent) {\n\t\tif (this.disabled) return;\n\t\tevent.preventDefault();\n\t\tthis.isDragOver = true;\n\t}\n\n\thandleDragLeave(event: DragEvent) {\n\t\tif (this.disabled) return;\n\t\tevent.preventDefault();\n\t\tthis.isDragOver = false;\n\t}\n\n\tprocessFiles(fileList: FileList) {\n\t\tconst selectedFiles = Array.from(fileList);\n\n\t\tconst validFiles: File[] = [];\n\t\tconst rejectedSize: string[] = [];\n\t\tconst rejectedType: string[] = [];\n\n\t\tselectedFiles.forEach((file) => {\n\t\t\tconst isValidType = this.isFileTypeAllowed(file);\n\t\t\tconst isValidSize = file.size <= this.maxFileSizeMB * 1024 * 1024;\n\t\t\tconst isDuplicate = this.files.some(\n\t\t\t\t(existing) =>\n\t\t\t\t\texisting.name === file.name && existing.size === file.size,\n\t\t\t);\n\n\t\t\tif (isDuplicate) {\n\t\t\t\tthis.ifxFileUploadInvalid.emit({ file, reason: \"duplicate\" });\n\t\t\t\tthis.ifxFileUploadError.emit({\n\t\t\t\t\tfile,\n\t\t\t\t\terrorType: \"duplicate\",\n\t\t\t\t\tmessage: `File \"${file.name}\" is already added`,\n\t\t\t\t\treason: \"duplicate\",\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (isValidType && isValidSize) {\n\t\t\t\tvalidFiles.push(file);\n\t\t\t} else {\n\t\t\t\tif (!isValidType) {\n\t\t\t\t\trejectedType.push(file.name);\n\t\t\t\t\tthis.ifxFileUploadInvalid.emit({ file, reason: \"invalid-type\" });\n\t\t\t\t}\n\t\t\t\tif (!isValidSize) {\n\t\t\t\t\trejectedSize.push(file.name);\n\t\t\t\t\tthis.ifxFileUploadInvalid.emit({ file, reason: \"invalid-size\" });\n\t\t\t\t}\n\t\t\t\tthis.ifxFileUploadError.emit({\n\t\t\t\t\tfile,\n\t\t\t\t\terrorType: !isValidType ? \"invalid-type\" : \"file-too-large\",\n\t\t\t\t\tmessage: \"Invalid file rejected\",\n\t\t\t\t\treason: !isValidType ? \"unsupported-type\" : \"file-too-large\",\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis.rejectedSizeFiles = [...this.rejectedSizeFiles, ...rejectedSize];\n\t\tthis.rejectedTypeFiles = [...this.rejectedTypeFiles, ...rejectedType];\n\n\t\tif (\n\t\t\tthis.maxFiles &&\n\t\t\tthis.files.length + validFiles.length > this.maxFiles\n\t\t) {\n\t\t\tconst availableSlots = this.maxFiles - this.files.length;\n\t\t\tconst limitedFiles = validFiles.slice(0, Math.max(availableSlots, 0));\n\t\t\tconst overflowFiles = validFiles.slice(availableSlots);\n\n\t\t\tthis.files = [...this.files, ...limitedFiles];\n\n\t\t\tlimitedFiles.forEach((file) => this.startUpload(file));\n\n\t\t\tif (limitedFiles.length > 0) {\n\t\t\t\tthis.ifxFileUploadAdd.emit({\n\t\t\t\t\taddedFiles: limitedFiles,\n\t\t\t\t\tfiles: this.files,\n\t\t\t\t});\n\t\t\t\tthis.ifxFileUploadChange.emit({ files: this.files });\n\t\t\t}\n\n\t\t\toverflowFiles.forEach((file) => {\n\t\t\t\tthis.ifxFileUploadInvalid.emit({ file, reason: \"too-many-files\" });\n\t\t\t\tthis.ifxFileUploadError.emit({\n\t\t\t\t\tfile,\n\t\t\t\t\terrorType: \"too-many-files\",\n\t\t\t\t\tmessage: `Upload limit exceeded. Max ${this.maxFiles} files allowed.`,\n\t\t\t\t\treason: \"too-many-files\",\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tif (overflowFiles.length > 0) {\n\t\t\t\tthis.statusMessage = {\n\t\t\t\t\ttype: \"error\",\n\t\t\t\t\ttext: this.labelMaxFilesExceeded\n\t\t\t\t\t\t.replace(\"{{count}}\", this.maxFiles.toString())\n\t\t\t\t\t\t.replace(\"{{files}}\", this.pluralize(this.maxFiles)),\n\t\t\t\t};\n\t\t\t\tthis.ifxFileUploadMaxFilesExceeded.emit({\n\t\t\t\t\tmaxFiles: this.maxFiles,\n\t\t\t\t\tattempted: this.files.length + validFiles.length,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tvalidFiles.forEach((file) => this.startUpload(file));\n\t\tthis.files = [...this.files, ...validFiles];\n\n\t\tif (validFiles.length > 0) {\n\t\t\tthis.ifxFileUploadAdd.emit({ addedFiles: validFiles, files: this.files });\n\t\t\tthis.ifxFileUploadChange.emit({ files: this.files });\n\t\t}\n\n\t\tthis.validateRequired();\n\t}\n\n\tretryUpload(file: File) {\n\t\tconst taskIndex = this.uploadTasks.findIndex(\n\t\t\t(t) => t.file.name === file.name,\n\t\t);\n\t\tif (taskIndex !== -1) {\n\t\t\tthis.uploadTasks.splice(taskIndex, 1);\n\t\t\tthis.uploadTasks = [...this.uploadTasks];\n\t\t}\n\t\tthis.ifxFileUploadRetry.emit({ file });\n\t\tthis.startUpload(file);\n\t}\n\n\tprivate checkAndEmitAllComplete(): void {\n\t\tif (this.uploadTasks.every((t) => t.completed || t.error)) {\n\t\t\tconst hasSuccessfulUploads = this.uploadTasks.some(\n\t\t\t\t(t) => t.completed && !t.error,\n\t\t\t);\n\t\t\tif (hasSuccessfulUploads) {\n\t\t\t\tconst successfulFiles = this.uploadTasks\n\t\t\t\t\t.filter((t) => t.completed && !t.error)\n\t\t\t\t\t.map((t) => t.file);\n\t\t\t\tthis.ifxFileUploadAllComplete.emit({ files: successfulFiles });\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate resetFileInput(): void {\n\t\tif (this.fileInputEl) {\n\t\t\tthis.fileInputEl.value = \"\";\n\t\t}\n\t}\n\n\tprivate updateTaskProgress(file: File, progress: number): void {\n\t\tconst task = this.uploadTasks.find((t) => t.file === file);\n\t\tif (task) {\n\t\t\tconst newProgress = Math.max(task.progress, Math.min(100, progress));\n\t\t\tif (newProgress !== task.progress) {\n\t\t\t\ttask.progress = newProgress;\n\t\t\t\tthis.uploadTasks = [...this.uploadTasks];\n\t\t\t}\n\t\t}\n\t}\n\n\tstartUpload(file: File) {\n\t\tthis.ifxFileUploadStart.emit({ file });\n\t\tconst task: UploadTask = {\n\t\t\tfile,\n\t\t\tprogress: 3, // Start with initial progress for better UX\n\t\t\tintervalId: null,\n\t\t\tcompleted: false,\n\t\t};\n\t\tthis.uploadTasks = [...this.uploadTasks, task];\n\n\t\tif (this.uploadHandler) {\n\t\t\tthis.uploadHandler(file, (percent: number) => {\n\t\t\t\tthis.updateTaskProgress(file, percent);\n\t\t\t})\n\t\t\t\t.then(() => {\n\t\t\t\t\ttask.progress = 100;\n\t\t\t\t\ttask.completed = true;\n\t\t\t\t\tthis.uploadTasks = [...this.uploadTasks];\n\t\t\t\t\tthis.ifxFileUploadComplete.emit({ file });\n\t\t\t\t\tthis.ifxFileUploadChange.emit({ files: this.files });\n\t\t\t\t\tthis.checkAndEmitAllComplete();\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\ttask.error = true;\n\t\t\t\t\tthis.uploadTasks = [...this.uploadTasks];\n\t\t\t\t\tthis.ifxFileUploadError.emit({\n\t\t\t\t\t\tfile,\n\t\t\t\t\t\terrorType: \"upload-failed\",\n\t\t\t\t\t\tmessage: \"Upload handler rejected file\",\n\t\t\t\t\t\treason: \"custom\",\n\t\t\t\t\t});\n\t\t\t\t\tthis.checkAndEmitAllComplete();\n\t\t\t\t});\n\t\t} else {\n\t\t\tconst totalSize = file.size;\n\t\t\tconst fakeUploadSpeed = 100000;\n\t\t\tlet uploaded = 0;\n\t\t\ttask.intervalId = window.setInterval(() => {\n\t\t\t\tuploaded += fakeUploadSpeed / 5;\n\t\t\t\tconst progress = Math.min(\n\t\t\t\t\t100,\n\t\t\t\t\tMath.round((uploaded / totalSize) * 100),\n\t\t\t\t);\n\t\t\t\tthis.updateTaskProgress(file, progress);\n\n\t\t\t\tif (progress >= 100) {\n\t\t\t\t\tclearInterval(task.intervalId!);\n\t\t\t\t\ttask.completed = true;\n\t\t\t\t\ttask.intervalId = null;\n\t\t\t\t\tthis.uploadTasks = [...this.uploadTasks];\n\t\t\t\t\tthis.ifxFileUploadComplete.emit({ file });\n\t\t\t\t\tthis.ifxFileUploadChange.emit({ files: this.files });\n\t\t\t\t\tthis.checkAndEmitAllComplete();\n\t\t\t\t}\n\t\t\t}, 200);\n\t\t}\n\t}\n\n\tcancelUpload(file: File) {\n\t\tconst taskIndex = this.uploadTasks.findIndex(\n\t\t\t(t) => t.file.name === file.name,\n\t\t);\n\t\tif (taskIndex !== -1) {\n\t\t\tconst task = this.uploadTasks[taskIndex];\n\t\t\tif (task?.intervalId !== null) {\n\t\t\t\tclearInterval(task.intervalId);\n\t\t\t}\n\t\t\tthis.uploadTasks = this.uploadTasks.filter((_, i) => i !== taskIndex);\n\t\t}\n\t\tthis.files = this.files.filter((f) => f.name !== file.name);\n\t\tthis.ifxFileUploadAbort.emit({ file });\n\t\tthis.ifxFileUploadChange.emit({ files: this.files });\n\t\tthis.resetFileInput();\n\t\tthis.validateRequired();\n\t}\n\n\tremoveFile(file: File) {\n\t\tthis.uploadTasks = this.uploadTasks.filter(\n\t\t\t(task) => task.file.name !== file.name,\n\t\t);\n\t\tthis.files = this.files.filter((f) => f.name !== file.name);\n\t\tthis.ifxFileUploadRemove.emit({ removedFile: file, files: this.files });\n\t\tthis.ifxFileUploadChange.emit({ files: this.files });\n\t\tthis.validateRequired();\n\n\t\tthis.resetFileInput();\n\n\t\tif (\n\t\t\tthis.maxFiles &&\n\t\t\tthis.files.length < this.maxFiles &&\n\t\t\tthis.statusMessage?.text !== this.labelRequiredError\n\t\t) {\n\t\t\tthis.statusMessage = null;\n\t\t}\n\t}\n\n\tclearRejectedFile(fileName: string, type: \"size\" | \"type\") {\n\t\tif (type === \"size\") {\n\t\t\tthis.rejectedSizeFiles = this.rejectedSizeFiles.filter(\n\t\t\t\t(f) => f !== fileName,\n\t\t\t);\n\t\t} else {\n\t\t\tthis.rejectedTypeFiles = this.rejectedTypeFiles.filter(\n\t\t\t\t(f) => f !== fileName,\n\t\t\t);\n\t\t}\n\n\t\tthis.resetFileInput();\n\n\t\tif (this.maxFiles && this.files.length < this.maxFiles) {\n\t\t\tthis.statusMessage = null;\n\t\t}\n\n\t\tthis.validateRequired();\n\t}\n\n\tsplitFileNameParts(file: File): { base: string; ext: string } {\n\t\tconst name = file.name;\n\t\tconst dotIndex = name.lastIndexOf(\".\");\n\t\tif (dotIndex === -1) return { base: name, ext: \"\" };\n\t\treturn {\n\t\t\tbase: name.substring(0, dotIndex),\n\t\t\text: name.substring(dotIndex),\n\t\t};\n\t}\n\n\tgetFileIcon(file: File): string {\n\t\tconst extension = file.name.split(\".\").pop()?.toLowerCase();\n\t\tswitch (extension) {\n\t\t\tcase \"pdf\":\n\t\t\t\treturn \"file-pdf-16\";\n\t\t\tcase \"jpg\":\n\t\t\tcase \"jpeg\":\n\t\t\t\treturn \"file-jpg-16\";\n\t\t\tcase \"png\":\n\t\t\t\treturn \"file-png-16\";\n\t\t\tcase \"mov\":\n\t\t\t\treturn \"file-mov-16\";\n\t\t\tcase \"mp3\":\n\t\t\t\treturn \"file-mp3-16\";\n\t\t\tcase \"mp4\":\n\t\t\t\treturn \"file-mp4-16\";\n\t\t\tdefault:\n\t\t\t\treturn \"file-16\";\n\t\t}\n\t}\n\n\tformatSize(bytes: number): string {\n\t\tif (bytes >= 1024 * 1024 * 1024) {\n\t\t\treturn `${(bytes / (1024 * 1024 * 1024)).toFixed(1)} GB`;\n\t\t} else if (bytes >= 1024 * 1024) {\n\t\t\treturn `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\n\t\t} else if (bytes >= 1024) {\n\t\t\treturn `${(bytes / 1024).toFixed(0)} KB`;\n\t\t} else {\n\t\t\treturn `${bytes} B`;\n\t\t}\n\t}\n\n\tgetAcceptAttribute(): string {\n\t\t// If allowAnyFileType is true, don't restrict the input\n\t\tif (this.allowAnyFileType) {\n\t\t\treturn \"\";\n\t\t}\n\n\t\tconst acceptValues: string[] = [];\n\n\t\t// Add extensions from allowedFileTypes\n\t\tconst extensionTypes = this.getNormalizedFileTypes().map(\n\t\t\t(ext) => \".\" + ext.toLowerCase(),\n\t\t);\n\t\tacceptValues.push(...extensionTypes);\n\n\t\t// Add MIME types from additionalAllowedFileTypes\n\t\tconst mimeTypes = this.getAdditionalMimeTypes();\n\t\tacceptValues.push(...mimeTypes);\n\n\t\t// Add custom file extensions\n\t\tconst customExtensions = this.getNormalizedFileExtensions();\n\t\tcustomExtensions.forEach((ext) => {\n\t\t\tconst normalizedExt = ext.startsWith(\".\") ? ext : \".\" + ext;\n\t\t\tacceptValues.push(normalizedExt);\n\t\t});\n\n\t\treturn acceptValues.join(\",\");\n\t}\n\n\tprivate getFormattedProgressText(task: UploadTask): string {\n\t\tconst uploadedSize = Math.round((task.progress / 100) * task.file.size);\n\t\tconst uploadedText = this.formatSize(uploadedSize);\n\t\tconst totalText = this.formatSize(task.file.size);\n\t\treturn `${uploadedText} / ${totalText} uploaded`;\n\t}\n\n\tprivate getAdditionalMimeTypes(): string[] {\n\t\tif (!this.additionalAllowedFileTypes) return [];\n\t\tif (Array.isArray(this.additionalAllowedFileTypes))\n\t\t\treturn this.additionalAllowedFileTypes;\n\t\treturn this.additionalAllowedFileTypes.split(\",\").map((t) => t.trim());\n\t}\n\n\tprivate getSupportedFileText(): string {\n\t\tif (this.allowAnyFileType) {\n\t\t\tlet text = `All file types allowed. Max file size: ${this.maxFileSizeMB}MB.`;\n\t\t\tif (this.labelMaxFilesInfo && this.maxFiles) {\n\t\t\t\tconst fileWord = this.pluralize(this.maxFiles);\n\t\t\t\tconst maxFilesText = this.labelMaxFilesInfo\n\t\t\t\t\t.replace(\"{{count}}\", this.maxFiles.toString())\n\t\t\t\t\t.replace(\"{{files}}\", fileWord);\n\t\t\t\ttext += ` ${maxFilesText}`;\n\t\t\t}\n\t\t\treturn text;\n\t\t}\n\n\t\tconst allTypes: string[] = [];\n\n\t\t// Add extensions from allowedFileTypes\n\t\tconst extensions = this.getNormalizedFileTypes().map((ext) =>\n\t\t\text.toUpperCase(),\n\t\t);\n\t\tallTypes.push(...extensions);\n\n\t\t// Add MIME types from additionalAllowedFileTypes\n\t\tconst mimeTypes = this.getAdditionalMimeTypes().map((mime) =>\n\t\t\tthis.getLabelFromMimeType(mime),\n\t\t);\n\t\tallTypes.push(...mimeTypes);\n\n\t\t// Add custom file extensions\n\t\tconst customExtensions = this.getNormalizedFileExtensions().map((ext) => {\n\t\t\tconst cleanExt = ext.startsWith(\".\") ? ext.substring(1) : ext;\n\t\t\treturn cleanExt.toUpperCase();\n\t\t});\n\t\tallTypes.push(...customExtensions);\n\n\t\tconst typesLabel = allTypes.join(\", \");\n\n\t\tlet text = this.labelSupportedFormatsTemplate\n\t\t\t.replace(\"{{types}}\", typesLabel)\n\t\t\t.replace(\"{{size}}\", this.maxFileSizeMB.toString());\n\n\t\tif (this.labelMaxFilesInfo && this.maxFiles) {\n\t\t\tconst fileWord = this.pluralize(this.maxFiles);\n\t\t\tconst maxFilesText = this.labelMaxFilesInfo\n\t\t\t\t.replace(\"{{count}}\", this.maxFiles.toString())\n\t\t\t\t.replace(\"{{files}}\", fileWord);\n\t\t\ttext += ` ${maxFilesText}`;\n\t\t}\n\n\t\treturn text;\n\t}\n\n\tprivate getFormattedFileTooLargeText(): string {\n\t\treturn this.labelFileTooLarge.replace(\n\t\t\t\"{{size}}\",\n\t\t\tthis.maxFileSizeMB.toString(),\n\t\t);\n\t}\n\n\tprivate renderStatusMessage() {\n\t\tif (!this.statusMessage) return null;\n\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclass={`file-upload-status file-upload-status__${this.statusMessage.type}`}\n\t\t\t>\n\t\t\t\t{this.statusMessage.type === \"error\" && (\n\t\t\t\t\t<ifx-icon icon=\"c-warning-16\"></ifx-icon>\n\t\t\t\t)}\n\t\t\t\t{this.statusMessage.text}\n\t\t\t</div>\n\t\t);\n\t}\n\n\tprivate isInputDisabled(): boolean {\n\t\treturn (\n\t\t\tthis.disabled ||\n\t\t\t(this.maxFiles !== undefined && this.files.length >= this.maxFiles)\n\t\t);\n\t}\n\n\tasync componentDidLoad() {\n\t\tif (!isNestedInIfxComponent(this.hostElement)) {\n\t\t\tconst framework = detectFramework();\n\t\t\ttrackComponent(\"ifx-file-upload\", await framework);\n\t\t}\n\n\t\tif (this.hostElement.hasAttribute(\"show-demo-states\")) {\n\t\t\tthis.showDemoStates = true;\n\t\t}\n\n\t\tif (this.showDemoStates) {\n\t\t\tthis.injectDemoState();\n\t\t}\n\t}\n\n\t// Storybook Demo\n\t@Method()\n\tasync injectDemoState() {\n\t\tconst dummyContent = new Array(50000).fill(\"a\").join(\"\"); // ~50 KB\n\t\tconst bigContent = dummyContent + dummyContent; // ~100 KB\n\n\t\tconst uploading = new File([dummyContent], \"Image.jpg\", {\n\t\t\ttype: \"image/jpeg\",\n\t\t}); // ~50 KB\n\t\tconst uploaded = new File([bigContent], \"File.pdf\", {\n\t\t\ttype: \"application/pdf\",\n\t\t}); // ~100 KB\n\t\tconst failed = new File([dummyContent], \"Text.docx\", {\n\t\t\ttype: \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\",\n\t\t}); // ~50 KB\n\t\tconst tooLarge = new File(\n\t\t\t[bigContent + bigContent + bigContent],\n\t\t\t\"Video.mp4\",\n\t\t\t{ type: \"video/mp4\" },\n\t\t); // ~300 KB\n\t\tconst unsupported = new File([\"demo\"], \"Script.exe\", {\n\t\t\ttype: \"application/x-msdownload\",\n\t\t}); // very small\n\n\t\tthis.files = [uploaded, uploading, failed];\n\t\tthis.uploadTasks = [\n\t\t\t{ file: uploaded, progress: 100, intervalId: null, completed: true },\n\t\t\t{ file: uploading, progress: 40, intervalId: null, completed: false },\n\t\t\t{\n\t\t\t\tfile: failed,\n\t\t\t\tprogress: 80,\n\t\t\t\tintervalId: null,\n\t\t\t\tcompleted: false,\n\t\t\t\terror: true,\n\t\t\t},\n\t\t];\n\t\tthis.rejectedSizeFiles = [tooLarge.name];\n\t\tthis.rejectedTypeFiles = [unsupported.name];\n\t}\n\n\t// Storybook Demo\n\t@Method()\n\tasync triggerDemoValidation(): Promise<void> {\n\t\tthis.validateRequired();\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclass={{\n\t\t\t\t\t\"file-upload-wrapper\": true,\n\t\t\t\t\tdisabled: this.disabled,\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{this.label && (\n\t\t\t\t\t<label class=\"file-upload-label\" htmlFor={this.internalId}>\n\t\t\t\t\t\t{this.label}\n\t\t\t\t\t\t{this.required && (\n\t\t\t\t\t\t\t<span class={`required ${this.requiredError ? \"error\" : \"\"}`}>\n\t\t\t\t\t\t\t\t*\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</label>\n\t\t\t\t)}\n\n\t\t\t\t{this.dragAndDrop\n\t\t\t\t\t? this.renderDragAndDropArea()\n\t\t\t\t\t: this.renderUploadArea()}\n\n\t\t\t\t{(this.files.length > 0 ||\n\t\t\t\t\tthis.rejectedSizeFiles.length > 0 ||\n\t\t\t\t\tthis.rejectedTypeFiles.length > 0) && (\n\t\t\t\t\t<div class=\"file-list-wrapper\">\n\t\t\t\t\t\t<div class=\"upload-heading\">{this.labelUploadedFilesHeading}</div>\n\t\t\t\t\t\t<ul class=\"file-list\">\n\t\t\t\t\t\t\t{this.rejectedSizeFiles.map((fileName) => (\n\t\t\t\t\t\t\t\t<li\n\t\t\t\t\t\t\t\t\tclass=\"file-item upload-failed\"\n\t\t\t\t\t\t\t\t\tkey={`rejected-size-${fileName}`}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div class=\"file-icon\">\n\t\t\t\t\t\t\t\t\t\t<ifx-icon icon=\"file-16\"></ifx-icon>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"file-info\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"file-top-row\">\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"file-name-wrapper\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"file-name-base\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.splitFileNameParts({ name: fileName } as File)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.base\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"file-name-ext\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.splitFileNameParts({ name: fileName } as File)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.ext\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"file-actions\">\n\t\t\t\t\t\t\t\t\t\t\t\t<ifx-icon-button\n\t\t\t\t\t\t\t\t\t\t\t\t\tshape=\"square\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"tertiary\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon=\"delete-forever-16\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"s\"\n\t\t\t\t\t\t\t\t\t\t\t\t\taria-label={this.ariaLabelRemoveFile}\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.clearRejectedFile(fileName, \"size\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t></ifx-icon-button>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"file-middle-row\">\n\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"file-status\"\n\t\t\t\t\t\t\t\t\t\t\t\taria-label={this.labelFileTooLarge.replace(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"{{size}}\",\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.maxFileSizeMB.toString(),\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t{this.getFormattedFileTooLargeText()}\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t))}\n\n\t\t\t\t\t\t\t{this.rejectedTypeFiles.map((fileName) => (\n\t\t\t\t\t\t\t\t<li\n\t\t\t\t\t\t\t\t\tclass=\"file-item upload-failed\"\n\t\t\t\t\t\t\t\t\tkey={`rejected-type-${fileName}`}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div class=\"file-icon\">\n\t\t\t\t\t\t\t\t\t\t<ifx-icon icon=\"file-16\"></ifx-icon>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"file-info\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"file-top-row\">\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"file-name-wrapper\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"file-name-base\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.splitFileNameParts({ name: fileName } as File)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.base\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"file-name-ext\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.splitFileNameParts({ name: fileName } as File)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.ext\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"file-actions\">\n\t\t\t\t\t\t\t\t\t\t\t\t<ifx-icon-button\n\t\t\t\t\t\t\t\t\t\t\t\t\tshape=\"square\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"tertiary\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon=\"delete-forever-16\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"s\"\n\t\t\t\t\t\t\t\t\t\t\t\t\taria-label={this.ariaLabelRemoveFile}\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.clearRejectedFile(fileName, \"type\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t></ifx-icon-button>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"file-middle-row\">\n\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"file-status\"\n\t\t\t\t\t\t\t\t\t\t\t\taria-label={this.labelUnsupportedFileType}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t{this.labelUnsupportedFileType}\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t))}\n\n\t\t\t\t\t\t\t{this.files.map((file) => {\n\t\t\t\t\t\t\t\tconst task = this.uploadTasks.find(\n\t\t\t\t\t\t\t\t\t(t) => t.file.name === file.name,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tconst progress = task?.progress ?? 100;\n\t\t\t\t\t\t\t\tconst isUploading = task && !task.completed;\n\t\t\t\t\t\t\t\tconst isError = task?.error === true;\n\t\t\t\t\t\t\t\tconst itemClass = isError\n\t\t\t\t\t\t\t\t\t? \"file-item upload-failed\"\n\t\t\t\t\t\t\t\t\t: isUploading\n\t\t\t\t\t\t\t\t\t\t? \"file-item uploading\"\n\t\t\t\t\t\t\t\t\t\t: \"file-item upload-success\";\n\t\t\t\t\t\t\t\tconst uniqueKey = `${file.name}-${file.size}`;\n\t\t\t\t\t\t\t\tconst { base, ext } = this.splitFileNameParts(file);\n\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<li class={itemClass} key={uniqueKey}>\n\t\t\t\t\t\t\t\t\t\t<div class=\"file-icon\">\n\t\t\t\t\t\t\t\t\t\t\t<ifx-icon icon={this.getFileIcon(file)}></ifx-icon>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"file-info\">\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"file-top-row\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"file-name-wrapper\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"file-name-base\">{base}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"file-name-ext\">{ext}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"file-actions\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ifx-icon-button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tshape=\"square\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"tertiary\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon=\"refresh-16\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"s\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\taria-label={this.ariaLabelRetryUpload}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => this.retryUpload(file)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisplay: isError ? \"inline-flex\" : \"none\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t></ifx-icon-button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ifx-icon-button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tshape=\"square\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"tertiary\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon=\"cross-16\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"s\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\taria-label={this.ariaLabelCancelUpload}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => this.cancelUpload(file)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisplay: isUploading ? \"inline-flex\" : \"none\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t></ifx-icon-button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ifx-icon-button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tshape=\"square\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"tertiary\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon=\"delete-forever-16\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"s\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\taria-label={this.ariaLabelRemoveFile}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => this.removeFile(file)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisplay: !isUploading ? \"inline-flex\" : \"none\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t></ifx-icon-button>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"file-middle-row\">\n\t\t\t\t\t\t\t\t\t\t\t\t{isUploading && task && !task.error && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"file-uploading\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\taria-label={this.ariaLabelUploadingStatus}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{this.getFormattedProgressText(task)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t{!isUploading && !isError && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"file-size\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{this.formatSize(file.size)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"file-status\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\taria-label={this.ariaLabelUploadedStatus}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ifx-icon icon=\"check-16\"></ifx-icon>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{this.labelUploaded}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t{isError && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"file-status\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\taria-label={this.ariaLabelUploadFailedStatus}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{this.labelUploadFailed}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t{isUploading && task && !task.error && (\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"file-progress-row\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ifx-progress-bar\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"s\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={progress}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tshow-label=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t></ifx-progress-bar>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderUploadArea() {\n\t\tconst handleInputRef = (el: HTMLInputElement | null) => {\n\t\t\tthis.fileInputEl = el;\n\t\t};\n\n\t\treturn (\n\t\t\t<div class={{ \"upload-button\": true }}>\n\t\t\t\t<ifx-button\n\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\tonClick={() => this.fileInputEl?.click()}\n\t\t\t\t\tdisabled={this.isInputDisabled()}\n\t\t\t\t\taria-label={this.ariaLabelBrowseFiles}\n\t\t\t\t>\n\t\t\t\t\t<ifx-icon icon=\"upload-16\"></ifx-icon>\n\t\t\t\t\t{this.labelBrowseFiles}\n\t\t\t\t</ifx-button>\n\t\t\t\t<input\n\t\t\t\t\tid={this.internalId}\n\t\t\t\t\tref={handleInputRef}\n\t\t\t\t\ttype=\"file\"\n\t\t\t\t\taccept={this.getAcceptAttribute()}\n\t\t\t\t\tmultiple\n\t\t\t\t\tonChange={(e) => this.handleFileChange(e)}\n\t\t\t\t\tstyle={{ display: \"none\" }}\n\t\t\t\t\tdisabled={this.isInputDisabled()}\n\t\t\t\t\taria-label={this.ariaLabelFileInput}\n\t\t\t\t/>\n\t\t\t\t<p class=\"file-upload-info\">{this.getSupportedFileText()}</p>\n\t\t\t\t{this.renderStatusMessage()}\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderDragAndDropArea() {\n\t\tconst handleInputRef = (el: HTMLInputElement | null) => {\n\t\t\tthis.fileInputEl = el;\n\t\t};\n\n\t\tconst triggerInputClick = () => {\n\t\t\tif (this.fileInputEl) {\n\t\t\t\tthis.fileInputEl.click();\n\t\t\t}\n\t\t};\n\n\t\treturn (\n\t\t\t<div class={{ disabled: this.isInputDisabled() }}>\n\t\t\t\t<div\n\t\t\t\t\tclass={{\n\t\t\t\t\t\t\"upload-dropzone\": true,\n\t\t\t\t\t\t\"drag-over\": this.isDragOver,\n\t\t\t\t\t\terror: this.requiredError,\n\t\t\t\t\t}}\n\t\t\t\t\tonClick={triggerInputClick}\n\t\t\t\t\tonDragOver={(e) => this.handleDragOver(e)}\n\t\t\t\t\tonDragLeave={(e) => this.handleDragLeave(e)}\n\t\t\t\t\tonDrop={(e) => this.handleDrop(e)}\n\t\t\t\t\trole=\"button\"\n\t\t\t\t\ttabIndex={0}\n\t\t\t\t\taria-label={this.ariaLabelDropzone}\n\t\t\t\t>\n\t\t\t\t\t<ifx-icon icon=\"upload-16\" class=\"custom-icon\"></ifx-icon>\n\t\t\t\t\t<p>{this.labelDragAndDrop}</p>\n\t\t\t\t\t<p class=\"file-upload-info\">{this.getSupportedFileText()}</p>\n\t\t\t\t\t<div style={{ height: \"0px\", overflow: \"hidden\" }}>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tid={this.internalId}\n\t\t\t\t\t\t\tref={handleInputRef}\n\t\t\t\t\t\t\ttype=\"file\"\n\t\t\t\t\t\t\taccept={this.getAcceptAttribute()}\n\t\t\t\t\t\t\tmultiple\n\t\t\t\t\t\t\tonChange={(e) => this.handleFileChange(e)}\n\t\t\t\t\t\t\tdisabled={this.isInputDisabled()}\n\t\t\t\t\t\t\taria-label={this.ariaLabelFileInput}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t{this.renderStatusMessage()}\n\t\t\t</div>\n\t\t);\n\t}\n}\n"],"mappings":"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","ignoreList":[]}