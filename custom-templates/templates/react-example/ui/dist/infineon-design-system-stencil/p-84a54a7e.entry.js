import{r as s,c as i,a as t,h as e}from"./p-CA_siwAQ.js";import{i as h}from"./p-CtINY9El.js";import{d as n,t as a}from"./p-DNHOWgWh.js";import{c as o}from"./p-BfP9ezJQ.js";const r=()=>`:host{display:inline-block}`;const c=class{constructor(t){s(this,t);this.ifxOpen=i(this,"ifxOpen",7);this.ifxClose=i(this,"ifxClose",7);this.ifxDropdown=i(this,"ifxDropdown",7)}placement="bottom-start";defaultOpen=false;internalIsOpen=false;noAppendToBody=false;ifxOpen;ifxClose;ifxDropdown;disabled;noCloseOnOutsideClick=false;noCloseOnMenuClick=false;get el(){return t(this)}trigger;menu;popperInstance;handleOutsideClick(s){const i=s.target;if(!this.noCloseOnOutsideClick&&!this.el.contains(i)&&!this.menu.contains(i)){this.closeDropdown()}}handleFocusOutside(s){const i=s.target;if(this.internalIsOpen&&!this.el.contains(i)&&!this.menu.contains(i)){this.closeDropdown()}}handleTriggerClick=()=>{if(!this.internalIsOpen)this.openDropdown();else this.closeDropdown()};handleTriggerKeyDown=s=>{const i=s.key;if(i==="Tab"&&this.internalIsOpen&&!s.shiftKey){s.preventDefault();this.focusFirstItem()}};handleMenuClick=()=>{if(!this.noCloseOnMenuClick)this.closeDropdown()};getItemFocusables(){if(!this.menu)return[];const s=Array.from(this.menu.querySelectorAll("ifx-dropdown-item"));return s.filter((s=>!(s.getAttribute("hide")==="true"||s.classList.contains("hide")))).map((s=>s.shadowRoot?.querySelector("a"))).filter((s=>!!s))}handleMenuKeyDown=s=>{const i=this.getItemFocusables();if(!i.length)return;const t=i.indexOf(document.activeElement);switch(s.key){case"ArrowDown":s.preventDefault();i[(t+1)%i.length].focus();break;case"ArrowUp":s.preventDefault();i[(t-1+i.length)%i.length].focus();break;case"Home":s.preventDefault();i[0].focus();break;case"End":s.preventDefault();i[i.length-1].focus();break;case"Enter":case" ":case"Spacebar":s.preventDefault();document.activeElement?.click();break;case"Escape":s.preventDefault();this.closeDropdown();this.trigger?.focus();break;case"Tab":if(s.shiftKey&&t===0){s.preventDefault();this.closeDropdown();this.trigger?.focus()}break}};componentWillLoad(){this.updateSlotContent();this.watchHandlerIsOpen(this.defaultOpen,this.internalIsOpen)}async componentDidLoad(){if(!h(this.el)){const s=n();a("ifx-dropdown",await s)}}watchHandlerIsOpen(s,i){if(s!==i&&s!==this.internalIsOpen){if(s){this.openDropdown()}else{this.closeDropdown()}}}watchHandlerDisabled(s){if(this.trigger){this.trigger.disabled=s}}watchHandlerSlot(){this.updateSlotContent()}focusFirstItem(){const[s]=this.getItemFocusables();s?.focus()}updateSlotContent(){const s=this.el.querySelector("ifx-dropdown-trigger-button, ifx-dropdown-trigger");if(s!==this.trigger){if(this.trigger){this.trigger.removeEventListener("click",this.handleTriggerClick);this.trigger.removeEventListener("keydown",this.handleTriggerKeyDown)}this.trigger=s;if(this.trigger){this.trigger.disabled=this.disabled;this.trigger.addEventListener("click",this.handleTriggerClick);this.trigger.addEventListener("keydown",this.handleTriggerKeyDown)}}const i=this.el.querySelector("ifx-dropdown-menu");if(!this.noAppendToBody){if(this.menu&&this.menu!==i){this.menu.removeEventListener("click",this.handleMenuClick);this.menu.removeEventListener("keydown",this.handleMenuKeyDown);this.menu.remove()}this.menu=i;if(this.menu&&!document.body.contains(this.menu)){document.body.append(this.menu)}}else{this.menu=i}if(this.menu){this.menu.removeEventListener("click",this.handleMenuClick);this.menu.removeEventListener("keydown",this.handleMenuKeyDown);this.menu.addEventListener("click",this.handleMenuClick);this.menu.addEventListener("keydown",this.handleMenuKeyDown)}}menuClickHandler(){if(!this.noCloseOnMenuClick){this.closeDropdown()}}disconnectedCallback(){if(this.popperInstance){this.popperInstance.destroy();this.popperInstance=null}if(this.menu){this.menu.remove()}}async isOpen(){return this.internalIsOpen}async closeDropdown(){if(this.internalIsOpen){this.internalIsOpen=false;this.trigger.isOpen=false;this.menu.isOpen=false;this.ifxClose.emit()}if(this.popperInstance){this.popperInstance.destroy();this.popperInstance=null}}async openDropdown(){if(!this.internalIsOpen&&!this.disabled){this.internalIsOpen=true;this.trigger.isOpen=true;this.menu.isOpen=true;this.popperInstance=o(this.el,this.menu,{placement:this.placement});this.ifxOpen.emit()}}render(){return e("div",{key:"4e98de0e83c6d6ff4416c495270f198bcabcf958","aria-label":"dropdown menu",class:"dropdown"},e("slot",{key:"a89296bd4a261e051586dade43c3815803969aec"}))}static get watchers(){return{defaultOpen:[{watchHandlerIsOpen:0}],disabled:[{watchHandlerDisabled:0}]}}};c.style=r();export{c as ifx_dropdown};
//# sourceMappingURL=p-84a54a7e.entry.js.map