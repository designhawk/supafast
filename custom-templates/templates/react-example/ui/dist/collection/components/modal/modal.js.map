{"version":3,"file":"modal.js","sourceRoot":"","sources":["../../../src/components/modal/modal.tsx"],"names":[],"mappings":"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","sourcesContent":["import {\n\tComponent,\n\tElement,\n\tEvent,\n\ttype EventEmitter,\n\tHost,\n\th,\n\tProp,\n\tState,\n\tWatch,\n} from \"@stencil/core\";\nimport { animationTo, KEYFRAMES } from \"../..//shared/utils/animation\";\nimport { isNestedInIfxComponent } from \"../..//shared/utils/dom-utils\";\nimport {\n\tisFocusable,\n\tisHidden,\n\tqueryShadowRoot,\n} from \"../..//shared/utils/focus-trap\";\nimport { detectFramework } from \"../..//shared/utils/framework-detection\";\nimport { trackComponent } from \"../../shared/utils/tracking\";\n\ntype CloseEventTrigger = \"CLOSE_BUTTON\" | \"ESCAPE_KEY\" | \"BACKDROP\";\n\nexport interface BeforeCloseEventDetail {\n\ttrigger: CloseEventTrigger;\n}\n@Component({\n\ttag: \"ifx-modal\",\n\tstyleUrl: \"modal.scss\",\n\tshadow: true,\n})\nexport class IfxModal {\n\t@Prop({ reflect: true, mutable: true }) opened?: boolean = false;\n\t@State() showModal: boolean = this.opened || false;\n\n\t@Prop() caption: string = \"Modal Title\";\n\t@Prop() captionAriaLabel: string | null;\n\n\t@Prop() closeOnOverlayClick: boolean = true;\n\n\t@Event() ifxOpen: EventEmitter;\n\t@Event() ifxClose: EventEmitter;\n\n\t@Prop() variant: \"default\" | \"alert-brand\" | \"alert-danger\" = \"default\";\n\n\t@Prop() size: \"s\" | \"m\" | \"l\" = \"s\";\n\n\t@Prop() alertIcon: string = \"\";\n\t@Prop() okButtonLabel: string = \"OK\";\n\t@Prop() cancelButtonLabel: string = \"Cancel\";\n\t@Prop() closeButtonAriaLabel: string | null;\n\n\t@Element() hostElement: HTMLElement;\n\n\t@State() slotButtonsPresent: boolean = false;\n\n\t@Prop() showCloseButton: boolean = true;\n\n\tprivate modalContainer: HTMLElement;\n\tprivate focusableElements: HTMLElement[] = [];\n\tprivate closeButton: HTMLButtonElement | HTMLIfxIconButtonElement;\n\tprivate resizeTimeout: ReturnType<typeof setTimeout>;\n\n\thandleResize = () => {\n\t\tclearTimeout(this.resizeTimeout);\n\t\tthis.resizeTimeout = setTimeout(() => {\n\t\t\tif (this.showModal) {\n\t\t\t\tthis.handleComponentOverflow();\n\t\t\t}\n\t\t}, 100);\n\t};\n\n\tasync componentDidLoad() {\n\t\tif (!isNestedInIfxComponent(this.hostElement)) {\n\t\t\tconst framework = detectFramework();\n\t\t\ttrackComponent(\"ifx-modal\", await framework);\n\t\t}\n\t\t// Query all focusable elements and store them in `focusableElements`.\n\t\t// Needed for the \"focus trap\" functionality.\n\t\tthis.focusableElements = queryShadowRoot(\n\t\t\tthis.hostElement.shadowRoot,\n\t\t\t(el) => isHidden(el) || el.matches(\"[data-focus-trap-edge]\"),\n\t\t\tisFocusable,\n\t\t);\n\t\twindow.addEventListener(\"resize\", this.handleResize);\n\t}\n\n\tdisconnectedCallback() {\n\t\twindow.removeEventListener(\"resize\", this.handleResize);\n\t}\n\n\tcomponentWillRender() {\n\t\tif (this.showModal) {\n\t\t\tthis.handleComponentOverflow();\n\t\t}\n\t}\n\n\tasync handleComponentOverflow() {\n\t\tconst modalContentContainer = this.hostElement.shadowRoot.querySelector(\n\t\t\t\".modal-content-container\",\n\t\t);\n\t\tif (\n\t\t\tthis.showModal &&\n\t\t\t(await this.isModalContentContainerHeightReachedViewport())\n\t\t) {\n\t\t\tmodalContentContainer.classList.add(\"no-overflow\");\n\t\t} else if (modalContentContainer?.classList.contains(\"no-overflow\")) {\n\t\t\tmodalContentContainer?.classList.remove(\"no-overflow\");\n\t\t}\n\t}\n\n\tgetFirstFocusableElement(): HTMLElement | null {\n\t\treturn this.focusableElements[0];\n\t}\n\n\tgetLastFocusableElement(): HTMLElement | null {\n\t\treturn this.focusableElements[this.focusableElements.length - 1];\n\t}\n\n\thandleTopFocus = () => {\n\t\tthis.attemptFocus(this.getLastFocusableElement());\n\t};\n\n\thandleBottomFocus = () => {\n\t\tthis.attemptFocus(this.getFirstFocusableElement());\n\t};\n\n\tattemptFocus(element: HTMLElement | null) {\n\t\tif (element == null) {\n\t\t\tsetTimeout(() => {\n\t\t\t\t//wait until DOM is fully loaded\n\t\t\t\tthis.closeButton.focus();\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\t//wait until DOM is fully loaded\n\t\t\telement.focus();\n\t\t}, 0);\n\t}\n\n\topen() {\n\t\tthis.showModal = true;\n\t\ttry {\n\t\t\tconst anim = animationTo(this.modalContainer, KEYFRAMES.fadeIn, {\n\t\t\t\tduration: 200,\n\t\t\t});\n\t\t\tanim.addEventListener(\"finish\", () => {\n\t\t\t\t// Setting focus on last item and removing immediately\n\t\t\t\t// so, on tab press first element is focused\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.getLastFocusableElement()?.focus();\n\t\t\t\t\tthis.getLastFocusableElement()?.blur();\n\t\t\t\t}, 0);\n\n\t\t\t\tthis.ifxOpen.emit();\n\t\t\t});\n\n\t\t\tthis.hostElement.addEventListener(\"keydown\", this.handleKeypress);\n\t\t} catch (err) {\n\t\t\tthis.ifxOpen.emit();\n\t\t}\n\t}\n\n\tclose() {\n\t\ttry {\n\t\t\tconst anim = animationTo(this.modalContainer, KEYFRAMES.fadeOut, {\n\t\t\t\tduration: 200,\n\t\t\t});\n\t\t\tanim.addEventListener(\"finish\", () => {\n\t\t\t\tthis.showModal = false;\n\t\t\t\tthis.ifxClose.emit();\n\t\t\t});\n\t\t\tthis.hostElement.removeEventListener(\"keydown\", this.handleKeypress);\n\t\t} catch (err) {\n\t\t\tthis.showModal = false;\n\t\t\tthis.ifxClose.emit();\n\t\t}\n\t}\n\n\thandleKeypress = (event: KeyboardEvent) => {\n\t\tif (!this.showModal) {\n\t\t\treturn;\n\t\t}\n\t\tif (event.key === \"Escape\") {\n\t\t\tthis.doBeforeClose(\"ESCAPE_KEY\");\n\t\t}\n\t};\n\n\tdoBeforeClose(trigger: CloseEventTrigger) {\n\t\tconst triggers = [];\n\t\ttriggers.push(trigger);\n\t\tconst prevented = triggers.some((event) => event.defaultPrevented);\n\t\tif (!prevented) {\n\t\t\tthis.opened = false;\n\t\t}\n\t}\n\n\t@Watch(\"opened\")\n\topenedChanged(newValue) {\n\t\tif (newValue === true) {\n\t\t\tthis.open();\n\t\t} else {\n\t\t\tthis.close();\n\t\t}\n\t}\n\n\thandleOverlayClick() {\n\t\tif (this.closeOnOverlayClick) {\n\t\t\tthis.doBeforeClose(\"BACKDROP\");\n\t\t}\n\t}\n\n\thandleContentUpdate(e) {\n\t\tconst slotElement = e.target;\n\t\tconst nodes = slotElement.assignedNodes();\n\t\tif (nodes.length > 0) {\n\t\t\tnodes.forEach((node) => {\n\t\t\t\tif (node.observer) {\n\t\t\t\t\tnode.observer.disconnect();\n\t\t\t\t\tdelete node.observer;\n\t\t\t\t}\n\t\t\t\tconst observer = new MutationObserver((mutationsList, _) => {\n\t\t\t\t\tfor (const mutation of mutationsList) {\n\t\t\t\t\t\tif (mutation.type === \"childList\") {\n\t\t\t\t\t\t\tif (this.showModal) {\n\t\t\t\t\t\t\t\tthis.handleComponentOverflow();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tobserver.observe(node, {\n\t\t\t\t\tattributes: true,\n\t\t\t\t\tchildList: true,\n\t\t\t\t\tsubtree: true,\n\t\t\t\t});\n\t\t\t\tnode.observer = observer;\n\t\t\t});\n\t\t}\n\t}\n\n\thandleButtonsSlotChange(e) {\n\t\tif (e.currentTarget.assignedElements()[0]?.childElementCount > 0) {\n\t\t\tthis.slotButtonsPresent = true;\n\t\t} else {\n\t\t\tthis.slotButtonsPresent = false;\n\t\t}\n\t}\n\n\tisModalContentContainerHeightReachedViewport() {\n\t\t//Adding timeout for proper height detection on Edge browser\n\t\treturn new Promise((resolve) => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst modalContent = this.hostElement.shadowRoot.querySelector(\n\t\t\t\t\t\".modal-content\",\n\t\t\t\t) as HTMLElement;\n\t\t\t\tconst modalContentHeight = modalContent.offsetHeight;\n\t\t\t\tconst viewportHeight = window.innerHeight;\n\t\t\t\tconst extraMarginForEdgeBrowser = 3;\n\t\t\t\tresolve(\n\t\t\t\t\tmodalContentHeight + extraMarginForEdgeBrowser >=\n\t\t\t\t\t\tviewportHeight * 0.9,\n\t\t\t\t);\n\t\t\t}, 100);\n\t\t});\n\t}\n\n\trender() {\n\t\tconst isAlertVariant = this.variant !== \"default\";\n\t\treturn (\n\t\t\t<Host>\n\t\t\t\t<div\n\t\t\t\t\tref={(el) => (this.modalContainer = el)}\n\t\t\t\t\tclass={`modal-container ${this.showModal ? \"open\" : \"\"}`}\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"modal-overlay\"\n\t\t\t\t\t\tonClick={() => this.handleOverlayClick()}\n\t\t\t\t\t></div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tdata-focus-trap-edge\n\t\t\t\t\t\tonFocus={this.handleTopFocus}\n\t\t\t\t\t\ttabindex=\"0\"\n\t\t\t\t\t></div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass={`modal-content-container ${this.size}`}\n\t\t\t\t\t\trole=\"dialog\"\n\t\t\t\t\t\taria-modal=\"true\"\n\t\t\t\t\t\taria-label={this.captionAriaLabel}\n\t\t\t\t\t>\n\t\t\t\t\t\t{isAlertVariant ? (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass={`modal-icon-container ${this.variant === \"alert-brand\" ? \"\" : \"danger\"}`}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{this.alertIcon ? <ifx-icon icon={this.alertIcon} /> : null}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t<div class=\"modal-content\">\n\t\t\t\t\t\t\t<div class=\"modal-header\">\n\t\t\t\t\t\t\t\t<h2 class=\"modal-caption\">{this.caption}</h2>\n\t\t\t\t\t\t\t\t{this.showCloseButton && (\n\t\t\t\t\t\t\t\t\t<ifx-icon-button\n\t\t\t\t\t\t\t\t\t\tclass=\"modal-close-button\"\n\t\t\t\t\t\t\t\t\t\tref={(el) => (this.closeButton = el)}\n\t\t\t\t\t\t\t\t\t\ticon=\"cross-16\"\n\t\t\t\t\t\t\t\t\t\tvariant=\"tertiary\"\n\t\t\t\t\t\t\t\t\t\tonClick={() => this.doBeforeClose(\"CLOSE_BUTTON\")}\n\t\t\t\t\t\t\t\t\t></ifx-icon-button>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"modal-body\">\n\t\t\t\t\t\t\t\t<slot\n\t\t\t\t\t\t\t\t\tname=\"content\"\n\t\t\t\t\t\t\t\t\tonSlotchange={(e) => this.handleContentUpdate(e)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass={`modal-footer ${this.slotButtonsPresent ? \"buttons-present\" : \"\"}`}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<slot\n\t\t\t\t\t\t\t\t\tname=\"buttons\"\n\t\t\t\t\t\t\t\t\tonSlotchange={(e) => this.handleButtonsSlotChange(e)}\n\t\t\t\t\t\t\t\t></slot>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tdata-focus-trap-edge\n\t\t\t\t\t\tonFocus={this.handleBottomFocus}\n\t\t\t\t\t\ttabindex=\"0\"\n\t\t\t\t\t></div>\n\t\t\t\t</div>\n\t\t\t</Host>\n\t\t);\n\t}\n}\n"]}