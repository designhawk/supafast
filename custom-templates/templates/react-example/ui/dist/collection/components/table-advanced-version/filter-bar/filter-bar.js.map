{"version":3,"file":"filter-bar.js","sourceRoot":"","sources":["../../../../src/components/table-advanced-version/filter-bar/filter-bar.tsx"],"names":[],"mappings":"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","sourcesContent":["// FilterBar.tsx\nimport {\n\tComponent,\n\tElement,\n\tEvent,\n\ttype EventEmitter,\n\tHost,\n\th,\n\tProp,\n\tState,\n} from \"@stencil/core\";\n\n@Component({\n\ttag: \"ifx-filter-bar\",\n\tstyleUrl: \"filter-bar.scss\",\n\tshadow: true,\n})\nexport class FilterBar {\n\t@Element() el: HTMLElement;\n\t@State() selectedOptions: Array<{\n\t\tfilterName: string;\n\t\tfilterValues: [string];\n\t\ttype: string;\n\t}> = [];\n\t@Event() ifxTopbarFilterChange: EventEmitter;\n\t@State() showAllFilters: boolean = false;\n\t@Prop() maxShownFilters: number = 4; // Default to 4, can be overridden by parent component\n\t@State() visibleSlots: number;\n\t@Prop() showMoreFiltersButton: boolean = true;\n\n\t/* If the component is ever removed and then reattached to the DOM, \nconnectedCallback ensures that the event listeners are properly set up again */\n\tconnectedCallback() {\n\t\tthis.el.addEventListener(\"ifxFilterSelect\", this.handleTopbarFilterChange);\n\t\tthis.el.addEventListener(\"ifxFilterSearchChange\", this.handleSearchChange);\n\t\twindow.addEventListener(\"ifxResetFiltersEvent\", this.handleResetEvent);\n\t}\n\n\tcomponentWillUnload() {\n\t\tthis.el.removeEventListener(\n\t\t\t\"ifxFilterSelect\",\n\t\t\tthis.handleTopbarFilterChange,\n\t\t);\n\t\tthis.el.removeEventListener(\n\t\t\t\"ifxFilterSearchChange\",\n\t\t\tthis.handleSearchChange,\n\t\t);\n\t\twindow.removeEventListener(\"ifxResetFiltersEvent\", this.handleResetEvent);\n\t}\n\n\tcomponentWillLoad() {\n\t\tthis.updateVisibleSlots();\n\t}\n\n\t// Modify updateVisibleSlots to use showAllFilters to determine the number of slots\n\tupdateVisibleSlots() {\n\t\tthis.visibleSlots = this.showAllFilters\n\t\t\t? Number.MAX_SAFE_INTEGER\n\t\t\t: this.maxShownFilters;\n\t}\n\n\thandleMoreFiltersClick = () => {\n\t\tthis.showAllFilters = true;\n\t\tthis.updateVisibleSlots(); // Recalculate visible slots based on the new state\n\t};\n\n\thandleResetEvent = () => {\n\t\tconst filterSearchSlot = this.el.shadowRoot?.querySelector(\n\t\t\t'slot[name=\"filter-search\"]',\n\t\t);\n\t\tif (filterSearchSlot instanceof HTMLSlotElement) {\n\t\t\t// Ensure it's treated as HTMLSlotElement\n\t\t\tconst filterSearchSlottedElements = filterSearchSlot.assignedElements({\n\t\t\t\tflatten: true,\n\t\t\t});\n\n\t\t\tfilterSearchSlottedElements.forEach(\n\t\t\t\t(filterSearchWrapper: HTMLElement) => {\n\t\t\t\t\tconst filterSearch =\n\t\t\t\t\t\tfilterSearchWrapper.querySelector(\"ifx-filter-search\");\n\n\t\t\t\t\tconst searchField =\n\t\t\t\t\t\tfilterSearch.shadowRoot.querySelectorAll(\"ifx-search-field\");\n\n\t\t\t\t\tif (searchField.length > 0) {\n\t\t\t\t\t\tsearchField.forEach((searchFieldElement: any) => {\n\t\t\t\t\t\t\tsearchFieldElement.value = \"\";\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\n\t\tthis.selectedOptions = [];\n\n\t\t// Emit the change to inform any parent components that the filters have been reset\n\t\tthis.ifxTopbarFilterChange.emit(this.selectedOptions);\n\t};\n\n\thandleSearchChange = (event: CustomEvent) => {\n\t\tthis.handleTopbarFilterChange(event);\n\t};\n\n\thandleFilterSelect = (event: CustomEvent) => {\n\t\tthis.handleTopbarFilterChange(event);\n\t};\n\n\thandleTopbarFilterChange = (event: CustomEvent) => {\n\t\tconst newSelectedOptions = [...this.selectedOptions];\n\n\t\tif (event.type === \"ifxFilterSearchChange\") {\n\t\t\tconst { filterName, filterValue } = event.detail;\n\t\t\tconst existingOptionIndex = newSelectedOptions.findIndex(\n\t\t\t\t(option) => option.filterName === filterName,\n\t\t\t);\n\n\t\t\tif (existingOptionIndex !== -1) {\n\t\t\t\t// If an existing filter is found, update its value\n\t\t\t\tnewSelectedOptions[existingOptionIndex].filterValues = [filterValue];\n\t\t\t} else {\n\t\t\t\tnewSelectedOptions.push({\n\t\t\t\t\tfilterName: filterName,\n\t\t\t\t\tfilterValues: [filterValue],\n\t\t\t\t\ttype: \"text\",\n\t\t\t\t});\n\t\t\t}\n\t\t} else if (event.type === \"ifxFilterSelect\") {\n\t\t\tconst { filterName, filterValues, type } = event.detail;\n\t\t\tconst existingOptionIndex = newSelectedOptions.findIndex(\n\t\t\t\t(option) => option.filterName === filterName,\n\t\t\t);\n\n\t\t\tif (existingOptionIndex !== -1) {\n\t\t\t\tnewSelectedOptions[existingOptionIndex].filterValues = filterValues;\n\t\t\t\tnewSelectedOptions[existingOptionIndex].type = type; // Update type based on the number of selected items\n\t\t\t} else {\n\t\t\t\tnewSelectedOptions.push({\n\t\t\t\t\tfilterName: filterName,\n\t\t\t\t\tfilterValues: filterValues,\n\t\t\t\t\ttype: type,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis.selectedOptions = newSelectedOptions;\n\t\tthis.ifxTopbarFilterChange.emit(this.selectedOptions);\n\t};\n\n\trender() {\n\t\tconst safeVisibleSlots = Math.max(0, this.visibleSlots);\n\n\t\tconst actualNumberOfComponents =\n\t\t\tthis.el.querySelectorAll(\"ifx-set-filter\").length;\n\t\t// Calculate slotsToShow safely\n\t\tconst slotsToShow = Math.min(\n\t\t\tsafeVisibleSlots,\n\t\t\tactualNumberOfComponents,\n\t\t\tNumber.MAX_SAFE_INTEGER,\n\t\t);\n\n\t\tconst slots = Array.from({ length: slotsToShow }, (_, i) => (\n\t\t\t<div class=\"filter-slot-wrapper\">\n\t\t\t\t<slot name={`filter-component-${i + 1}`}></slot>\n\t\t\t</div>\n\t\t));\n\n\t\treturn (\n\t\t\t<Host>\n\t\t\t\t<div class=\"search-container\">\n\t\t\t\t\t<slot name=\"filter-search\"></slot>{\" \"}\n\t\t\t\t\t{/* Directly place the search slot here */}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"components-container\">\n\t\t\t\t\t{slots.length > 0 ? slots : <slot name=\"filter-component\"></slot>}\n\t\t\t\t\t{this.showMoreFiltersButton && !this.showAllFilters && (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"more-filters-wrapper\"\n\t\t\t\t\t\t\tonClick={this.handleMoreFiltersClick}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<ifx-button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tdisabled={false}\n\t\t\t\t\t\t\t\tvariant=\"tertiary\"\n\t\t\t\t\t\t\t\tsize=\"m\"\n\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t\ttheme=\"default\"\n\t\t\t\t\t\t\t\tfull-width=\"false\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<ifx-icon icon=\"filter-16\"></ifx-icon>More filters\n\t\t\t\t\t\t\t</ifx-button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</Host>\n\t\t);\n\t}\n}\n"]}